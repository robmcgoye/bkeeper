<%= render 'shared/error_messages', resource: contribution %>
<%= form_with model: contribution, url: form_url do |f| %>
  <%= f.hidden_field :organization_id, value: contribution.organization.id %>
  <%= f.hidden_field :show, value: show %>
  <%= f.fields_for :register do |register_builder| %>
    <div class="card-body">
      
      <div class="row mb-2 border-bottom border-3 border-primary">
        <div class="col"><%= contribution.organization.name %></div>
        <div class="col"><%= contribution.organization.contact %></div>
        <div class="col">
          <span class="text-primary">TYPE:</span> <%= contribution.organization.organization_type.code %>
        </div>
      </div>

      <div class="row mb-2">
        <div class="col-sm-3 px-0">
          <%= register_builder.date_field :transaction_at, class: "form-control form-control-sm" %>
        </div>
        <div class="col-sm-2 text-end">
          <%= register_builder.label :check_number, "Check #" %>
        </div>
        <div class="col-sm 3 px-0">
          <%= register_builder.text_field :check_number, class: "form-control form-control-sm" %>
        </div>
        <div class="col-sm-1 text-end">
          <%= register_builder.label :amount, "Amt" %>
        </div>
        <div class="col-sm 3 px-0">
          <%= register_builder.text_field :amount, class: "text-end form-control form-control-sm" %>
        </div>
      </div>

      <div class="row mb-2">
        <div class="col-sm-2">
          <%= f.label :funding_source_id, "Funding" %>
        </div>
        <div class="col-sm 4 px-0">
          <%= f.collection_select :funding_source_id, @foundation.funding_sources, :id, :code,  
            {include_blank: 'Choose...'}, {class: "form-select form-select-sm"}  %>
        </div>
        <div class="col-sm-2 text-end">
          <%= f.label :bank_account_id, "Account" %>
        </div>
        <div class="col-sm 4 px-0">
          <%= register_builder.collection_select :bank_account_id, @foundation.bank_accounts, :id, :full_name,  
            {include_blank: 'Choose...'}, {class: "form-select form-select-sm"}  %>
        </div>          
      </div>

      <div class="row mb-2">
        <div class="col-sm-2">
          <%= f.label :donor_id, "Donor" %>
        </div>
        <div class="col-sm 4 px-0">
          <%= f.collection_select :donor_id, @foundation.donors.sort_full_name_up, :id, :full_name,  
            {include_blank: 'Choose...'}, {class: "form-select form-select-sm"}  %>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <%= register_builder.label :description %><br />
          <%= register_builder.text_area :description, class: "form-control", rows: 3 %>          
        </div>
      </div>

    </div>
    <div class="card-footer">
      <div class="row">
        <div class="col text-start">
          <%= link_to cancel_foundation_contribution_path(@foundation, get_id(contribution), :show => show), class: "btn btn-sm btn-outline-secondary text-start" do %>
            <i class="bi bi-x-square pe-1"></i>Cancel
          <% end %>  
        </div>
        <div class="col text-end"> 
          <%= f.button class: "btn btn-sm btn-outline-secondary text-start" do %>
            <%= "#{get_id(contribution) == -1 ? "Finish" : "Save" }" %>
            <i class="bi bi-arrow-right-circle ps-1"></i>
          <% end %>
        </div>
      </div>        
    </div>
  <% end %>
<% end %>

